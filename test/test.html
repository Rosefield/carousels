<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Development Test</title>
    <script type="text/javascript" src="../dist/carousels.js"></script>
</head>
<body>
    <h2>Input Code</h2>
    <pre id="CODE">
        fn merge_sort_dedup<T, P: Obliv>(a: &[Possession<T, P>])
        -> Vec<Possession<T, P>>
        where T: Ord + Clone
        {
            let n = a.len();
            if n > 1 {
                let m = n/2;
                merge_dedup(&merge_sort_dedup(&a[0..m]),
                            &merge_sort_dedup(&a[m..n]))
            } else {
                a.to_owned()
            }
        }

        fn merge_dedup<T, P: Obliv>(a: &[Possession<T, P>], b: &[Possession<T, P>])
        -> Vec<Possession<T, P>>
        where T: Ord + Clone
        { }
    </pre>

    <h2>Parsed as IR</h2>
    <pre id="IR"></pre>

    <h2>Costs</h2>
    <pre id="COSTS"></pre>

    <h2>Result</h2>
    <h3>Parameters</h3> <pre id="parameters"></pre>
    <h3>Description</h3> <pre id="description"></pre>
    <h3>Equations</h3> <pre id="eq"></pre>
</body>
<script type="text/javascript">
    carousels.promise.then(function () {
        try {
            const language = 'rust';
            const code = document.getElementById('CODE').innerHTML;
            const costs = carousels.costs.rustBGW;

            // TODO: remove this
            const IRCode = carousels.parsers.rust(code);
            document.getElementById('IR').textContent = JSON.stringify(IRCode, null, 2);
            document.getElementById('COSTS').textContent = JSON.stringify(costs, null, 2);

            const output = carousels.analyze(language, code, costs, costs['metrics'][0]['title']);
            console.log(output);
            document.getElementById('parameters').textContent = output.parameters.join('\n');
            document.getElementById('description').textContent = output.description.join('\n\n');
            document.getElementById('eq').textContent = output.equations.join('\n\n');
        } catch (err) {
          console.log(err);
        }
    });
</script>
</html>